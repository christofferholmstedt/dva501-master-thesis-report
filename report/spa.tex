\chapter{How the Space plug-and-play Architecture works}\label{ch:spa}
This section will go through how the Space plug-and-play Architecture (SPA)
works in detail with system sequence diagrams and component overviews.
Throughout this section UML 2 will be used. It's worth remembering
that the purpose of these diagrams is to show the reader how SPA works, the
purpose is not to give a complete picture to developers with all the
implementation details.

\section{Basic concepts and terminology in SPA}
Space plug-and-play Architecture (SPA) is a set of standards that define how
different players can create plug-and-play components that can easily be
assembled to form a complete satellite for a specific mission. The standards
are published by American Institute of Aeronatuics and Astronautics (AIAA). The
standards range from how power supply should be handled to how components
communicate in the application layer, focus in this report is put on the
software parts.

To describe how a SPA network works some terminology needs to be defined. All
nodes in a SPA network are called "components", there is no differentiation
between software and hardware components. Each component has a "Component
Universally Unique Identifier" (CUUID) which is 128 bit long. Each component
also has a "Extensible Transducer Electronic Data Sheet" (xTEDS) file that
describes respective components capabilities. To be able to support different
underlying link layer technologies such as Ethernet, Spacewire and one-wire
(I2C), most functionality has been put in the application layer. This means
that a SPA network can be built with any combination of link layer "subnets",
for example a SPA network can consist of two Spacewire subnets and one Ethernet
subnet.

The important concepts to remember is that each SPA component is
connected to one or more SPA subnets, on each SPA subnet there is a subnet
manager (SM-x) that acts as a gateway to other SPA subnets and when SPA subnets
are linked together they form a SPA network.

Another SPA subnet is the SPA Local Subnet. Each processing node that can
have multiple SPA components running on it has a "SPA Local Subnet Manager"
(SM-L).  Components within a processing node should do inter-process
communication over UDP/IP \cite{spa:local-subnet}.

Components communicate with each other with the help of "logical addresses"
that each component recieves during boot up. It's the responsiblity of the
"Central Addressing Service" (CAS) to hand out logical addresses to all
components in the SPA network. After a component receives its logical address
it can share its xTEDS file with other components. It's the responsibility of
the "Lookup Service" to keep track of all components' capabilities in the SPA
network.

To describe what a SPA network can look like figure TODO shows a minimal SPA
network which consists of a CAS, LS, a sensor and a monitor application, all
running on the same processing node and in the same local subnet managed by the
SM-L.

A more complex SPA network is shown in figure TODO. The original SPA network is
extended with multiple SPA subnets connected to the original SPA Local Subnet.

For a detailed view on how SPA works the SPA standards is the best source for
information though chapter \ref{ch:spa} will go through some scenarios in
detail that can be helpful to the reader to understand SPA. The SPA standards
and drafts that specify software requirements are the Logical Interface
standard \cite{spa:logical-interface}, Networking standard
\cite{spa:networking}, Local Subnet Draft \cite{spa:local-subnet}, Ontology
Standard \cite{spa:ontology} and System Capabilities Standard
\cite{spa:system-capabilities}.

\subsection{A single SPA local subnet - Overview}
TODO: Add this as image above in the "Basic Concept section"

\subsection{A single SPA local subnet - Boot up sequence diagrams}
TODO: Add this as image above in the "Basic Concept section"

\subsection{A single SPA local subnet - Normal operation sequence diagrams}
TODO: Add this as image above in the "Basic Concept section"

\subsection{Two local subnets and two ethernet subnets - Overview}
TODO: Add this as image above in the "Basic Concept section"

The subnets are connected in a straight series. One processsing node, one
ethernet subnet, one processing node and then another ethernet subnet.

\subsection{Two local subnets and two ethernet subnets - Boot up sequence diagrams}
TODO: Add this as image above in the "Basic Concept section"

\section{Virtual Network and the Virtual Network Protocol}
TODO: Finish of with the definition of Virtual Network, Virtual Network
Protocol and how it relates to SPA.

TODO: Is this needed or should VNP perhaps only be mentioned in context with
development efforts and code? This would mean that all comments about VN/VNP is
pushed to the results and conclusion parts...perhaps some in the method.
